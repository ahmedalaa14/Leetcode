# Write your MySQL query statement below
select product_id,coalesce(round(sum(price*units)/sum(units),2),0) as average_price from (select p.product_id as product_id,p.price as price,u.units as units from Prices as p left join UnitsSold as u on p.product_id = u.product_id and p.start_date <= u.purchase_date and u.purchase_date <= p.end_date) as t group by product_id